---
title: "Visualisations"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{visualisations}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r loading libraries, warning=FALSE, message=FALSE}
library(publicationsscraper)
library(ggplot2)
library(dplyr)
```


# Top Authors by Publications
```{r, warning=FALSE}
author_names <- paste(orcid_gsid$first_name, orcid_gsid$last_name)
get_all_publications(orcid_gsid) |> 
  filter(authors %in% author_names) |>  
  group_by(authors) |>  
  summarise(total_publications = n()) |>  
  arrange(desc(total_publications)) |>  
  slice_max(total_publications, n = 5) |>  
  ggplot(aes(x = reorder(authors, total_publications), 
             y = total_publications, 
             fill = ifelse(authors == first(authors), "highlight", "normal"))) + 
  geom_bar(stat = "identity") +
  coord_flip() +
  scale_fill_manual(values = c("highlight" = "red", "normal" = "green"), guide = FALSE) +  
  theme_light() +
  labs(title = "Top 5 Authors by Number of Publications",
       x = "Author",
       y = "Number of Publications")
```

# Publications by Year 
```{r}
get_all_publications(orcid_gsid) |>
  dplyr::filter(!is.na(publication_year)) |>
  dplyr::count(publication_year) |>
  ggplot(aes(x = as.numeric(publication_year), y = n)) +  
  geom_line(color= "red") +
  theme_light() +
  labs(title = "Publications Over Time", x = "Year", y = "Number of Publications")
```

# Publications by Journal
```{r}
get_all_publications(orcid_gsid) |> 
  filter(!is.na(journal_name) & journal_name != "") |> 
  group_by(journal_name) |> 
  summarise(total_publications = n()) |> 
  arrange(desc(total_publications)) |> 
  slice_max(total_publications, n = 10) |>  
  ggplot(aes(x = reorder(journal_name, total_publications), y = total_publications))  +
  geom_bar(stat = "identity", fill = "lightskyblue4") +
  coord_flip() +
  theme_light() +
  labs(title = "Top 10 Journals by Number of Publications",
       x = "Journal",
       y = "Number of Publications")
```


# Top Packages by Downloads 
```{r}
cran_all_pubs(orcid_gsid) |> 
  dplyr::arrange(desc(downloads)) |> 
  dplyr::top_n(10, downloads) |> 
  ggplot(aes(x = reorder(name, downloads), 
             y = downloads, 
             fill = ifelse(name == first(name), "highlight", "normal"))) +  
  geom_bar(stat = "identity") + 
  scale_fill_manual(values = c("highlight" = "blue", "normal" = "gold"), guide = FALSE) +  
  theme_light() + 
  coord_flip() + 
  labs(title = "Top 10 Packages by Downloads", 
       x = "Package Name", 
       y = "Downloads")
```

# Top Authors by Downloads

```{r}
# loop the authors
# only monash authors

cran_all_pubs(orcid_gsid) |> 
  group_by(authors) |> 
  summarise(total_downloads = sum(downloads, na.rm = TRUE)) |> 
  arrange(desc(total_downloads)) |> 
  slice_max(total_downloads, n = 10) |> 
  ggplot(aes(x = reorder(authors, total_downloads), y = total_downloads)) +
  geom_bar(stat = "identity", fill = "orange") +
  coord_flip() +
  theme_light() +
  labs(title = "Top 10 Authors by Package Downloads",
       x = "Author",
       y = "Total Downloads")
```








